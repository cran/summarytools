---
title: "Introduction to summarytools"
author: "Dominic Comtois"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to summarytools 0.8}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
library(summarytools)
library(knitr)
opts_chunk$set(comment=NA, prompt=FALSE, cache=FALSE)
```

**`summarytools`** is an _R_ package providing tools to neatly and quickly summarize data, with functions that most R programmers once wished were included in base R. It can also make _R_ a little easier to use for newbies. With a few lines of simple code, you can get a good look at the data at hand.

An emphasis has been put on both _what_ and _how_ results are presented, so that the package can serve both as a data exploration _and_ reporting tool than can be used either on its own for minimal reports, or integrated in a larger set of tools such as RStudio's for [rmarkdown](http://rmarkdown.rstudio.com/) and [knitr](https://yihui.name/knitr/).

## Four Core Functions

The package is built around four main functions:

- **freq()** -- **Frequency tables** with proportions, cumulative proportions and missing data information
- **ctable()** -- **Cross-Tabulations** with row, column, or total proportions, as well as marginal totals
- **descr()** -- **Descriptive (univariate) statistics** for numerical vectors which is more thorough than `fivenum()` and other similar functions
- **dfSummary()** -- **Data frame summaries** that facilitate data cleaning and firsthand evaluation

## Output Options

All `summarytools` objects returned by the main functions can be:

- Displayed as plain text in the console (default behavior)
- Redirected to plain text, _markdown/rmarkdown_ or HTML documents
- Rendered to HTML and shown in default Web Browser or in _RStudio_'s Viewer

Text-based output relies on the [pander](https://github.com/Rapporter/pander) package, while html output relies on RStudio's [htmltools](https://github.com/rstudio/htmltools).


## Bare-Bones Example: Frequency Table

To show what default (console) outputs look like, we'll first generate a frequency table for `iris$Species`.

```{r barebones}
freq(iris$Species)
```

To get familiar with the output styles, try different values for `style=` and see how results look in the console. 

### Markdown Outputs

When using `style='rmarkdown'` with `freq()` or `descr()`, the generated outputs are ready for markdown rendering. With `dfSummary()`, options for `style` are "multiline" (default) and "grid", and `plain.ascii=FALSE` must be used to have proper line feeds in multiline cells.

**Note:** In an .Rmd document with `knitr`, always set the chunk option `results='asis'`:

````
```{r, results='asis'}`r ''`
library(summarytools)  
freq(tobacco$smoker, style='rmarkdown')  
```
````

```{r, results='asis', echo=FALSE}
library(summarytools)  
freq(tobacco$smoker, style='rmarkdown')
```


## Descriptive (Univariate) Statistics

The `descr()` function accepts both vectors and data frames, in which case it will show statistics for all numerical variables it contains. We'll use one of the datasets included in the package.

```{r descr_md, results='asis'}
data(exams)
descr(exams[ ,3:5], style='rmarkdown')
```

To rather see variables in rows and stats in columns, use `transpose=TRUE`:

```{r descr_md2, eval=FALSE}
descr(exams, style = 'rmarkdown', transpose = TRUE)
```

### Cross-Tabulations

Let a few examples speak for themselves. First, a bare-bones cross-tabulation.

```{r ctable2}
with(tobacco, ctable(smoker, diseased, prop = 'n', totals = FALSE))
```

Then show proportions, by row.

```{r ctable1}
with(tobacco, ctable(smoker, diseased, prop = 'r'))
```


The type of table generated by ctable() is unfortunately not (yet) supported by `rmarkdown`. But we can turn to the `render` method to circumvent this:

```{r render_html, results='asis'}
crosstable <- with(tobacco, ctable(smoker, diseased))
print(crosstable, method='render', footnote = NA)
```

### Data frame Summaries

This is the most elaborate function of the package. It incorporates elements of freq() and descr(), but goes beyond with its graphs (not yet supported with `rmarkdown`) and other attributes. 

```{r dfSummary1, results='asis'}
dfSummary(tobacco, style='grid', plain.ascii = FALSE, graph.col = FALSE)
```

For this one, we can use styles "multiline" (default) or "grid". We **must** however specify `plain.ascii=FALSE` when using markdown, otherwise the rendered results will be problematic.

## Redirecting Output

### Text/Markdown Documents

Using the `file=` parameter with the `view()` or `print()` functions, we can redirect output into text files. And setting `append=TRUE` will append results to an existing text file:

```{r redir, eval=FALSE}
my_summary <- dfSummary(tobacco)  
print(my_summary, file = "tobacco.txt", style = "grid")  # Creates tobacco.txt
my_stats <- descr(tobacco)
print(my_stats, file="tobacco.txt", append = TRUE) # Appends results to tobacco.txt
```

As you may have noticed, the `style` argument was used when calling the `print()` function. We could also have used it when calling the `dfSummary()` and `descr()` functions, in which case the style would have been written in the objects' properties. Using this argument with `print()` overrides the style that is stored in the object. It is one of several arguments that can be used that way. See the documentation for `print()` to know all the details.

### HTML Documents

`summarytools` uses [Bootstrap](http://getbootstrap.com/css/#tables)'s stylesheets to generate standalone HTML documents that can be displayed in a Web Browser or in _RStudio_'s Viewer using the generic `print()` function:

```{r view_html, eval=FALSE}
print(dfSummary(tobacco), method = 'browser')  # Displays results in default Web Browser
print(dfSummary(tobacco), method = 'viewer')   # Displays results in RStudio's Viewer
view(dfSummary(tobacco))                       # Same as line above -- view() is a wrapper function
```

Using `file=` argument with an .html extension will simply generate an HTML document (without opening it). 

```{r create_html, eval=FALSE}
print(dfSummary(tobacco), file = '~/Documents/tobacco_summary.html')
```

Here is a picture of the output:

<img src="dfSummary-tobacco.png" alt="dfSummary in HTML format" style="width: 680px;"/>

As with simple text files, you can also append existing HTML reports with additionnal content.


## Using by(), with(), and lapply()

Summarytools functions support the use of `by()`, `with()`, and `lapply()`, at least when used in good measure. 

Since objects generated by those native functions have their own class (they are special lists containing summarytools objects), they are not sent to the package's generic print method automatically. In order to have the best results, the following method is recommended: First, store the object generated by one of the native functions. Then, use `view()` either with `method='pander'` to show results in console, or omitting the `method` argument to see (HTML) results in the Viewer or Browser.

```{r by_stats1, results='asis'}
stats <- by(data = exams$geography, INDICES = exams$gender, FUN = descr, style = 'rmarkdown')
view(stats, method = 'pander')
```

## Other Tricks To Try Out

There are many things you can do to build elaborate, fine-tuned reports. Let's mention a few...

- For HTML reports, footnotes can be customized or removed
- For text reports, captions can be added with the `caption=` argument
- Text files as well as HTML files can be appended with as many results you need
- Custom CSS can be added -- you can specify custom classes for any table you generate
  For instance:
```r
view(with(tobacco, ctable(gender, smoker)), 
     report.title = "Summary of the tobacco sample data frame",
      html.table.class = "table table-bordered table-striped table-responsive",
      footnote = "Extended use of Bootstrap classes")
```

## Getting Most Properties of an Object With `what.is()`

When developing, we often use a number functions to obtain an object's properties. `what.is()` proposes to lump together the results of such functions (`class()`, `typeof()`, `attributes()` and others).

```{r what_is, warning=FALSE}
what.is(iris)
```

## Limitations

- The graph column in dfSummary is not yet supported in `rmarkdown`  
- It is not possible to control the heading levels of individual items  

## Learn more and stay up-to-date

Check the [project's page](https://github.com/dcomtois/summarytools) for more examples; from there you can also submit feature requests or signal problems you might encounter.

To install the package in its development version, use

```r
install.packages('devtools')
library(devtools)
install_github('dcomtois/summarytools', ref='dev-current')
```

### Final note
The source of this document is an .Rmd file; `knitr`'s chunk option `results` has been set to `'asis'`, to make sure formatting is not coming from `knitr` itself.
